From c557bb0910be271e49563756411a690a1bc53ce5 Mon Sep 17 00:00:00 2001
From: Dario Lombardo <lomato@gmail.com>
Date: Wed, 27 Feb 2019 15:02:01 +0100
Subject: [PATCH] rpcap: check conversation existence before dereferencing it.

Conflicts:
	epan/dissectors/packet-rpcap.c

Bug: 15536
Change-Id: I370b7f4b3f647243490cbfadc120f0198c62b09b
Reviewed-on: https://code.wireshark.org/review/32232
Petri-Dish: Dario Lombardo <lomato@gmail.com>
Tested-by: Petri Dish Buildbot
Reviewed-by: Anders Broman <a.broman58@gmail.com>
(cherry picked from commit 2f048c932d0c063bd53651d0fd8f31a66eede741)
Reviewed-on: https://code.wireshark.org/review/32236
Reviewed-by: Gerald Combs <gerald@wireshark.org>
---
diff --git a/epan/dissectors/packet-rpcap.c b/epan/dissectors/packet-rpcap.c
index 58ce396..393523a 100644
--- a/epan/dissectors/packet-rpcap.c
+++ b/epan/dissectors/packet-rpcap.c
@@ -1106,7 +1106,8 @@ dissect_rpcap_heur_tcp (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, voi
      * as such.
      */
     conversation_t *conversation = find_conversation_pinfo (pinfo, 0);
-    conversation_set_dissector_from_frame_number (conversation,
+    if (conversation)
+      conversation_set_dissector_from_frame_number (conversation,
                                                   pinfo->num,
                                                   rpcap_tcp_handle);
     tcp_dissect_pdus (tvb, pinfo, tree, rpcap_desegment, 8,
